/*   Util_FileManager.incl   1.0.3*/include "Util_PathUtilities.incl"include "Util_URL.incl"// NSDirectoryEnumerationOptions#if ndef _DEFINEDINCOCOA#define NSDirectoryEnumerationOptions as UInt64#endifsystem NSDirectoryEnumerationOptions NSDirectoryEnumerationSkipsSubdirectoryDescendantssystem NSDirectoryEnumerationOptions NSDirectoryEnumerationSkipsPackageDescendantssystem NSDirectoryEnumerationOptions NSDirectoryEnumerationSkipsHiddenFiles// NSFileAttributeKey, NSFileAttributeType, NSFileProtectionType#if ndef _DEFINEDINCOCOA#define NSFileAttributeKey as CFStringRef#define NSFileAttributeType as CFStringRef#define NSFileProtectionType as CFStringRef#endifsystem NSFileAttributeKey NSFileTypesystem NSFileAttributeType NSFileTypeDirectorysystem NSFileAttributeType NSFileTypeRegularsystem NSFileAttributeType NSFileTypeSymbolicLinksystem NSFileAttributeType NSFileTypeSocketsystem NSFileAttributeType NSFileTypeCharacterSpecialsystem NSFileAttributeType NSFileTypeBlockSpecialsystem NSFileAttributeType NSFileTypeUnknownsystem NSFileAttributeKey NSFileSizesystem NSFileAttributeKey NSFileModificationDatesystem NSFileAttributeKey NSFileReferenceCountsystem NSFileAttributeKey NSFileDeviceIdentifiersystem NSFileAttributeKey NSFileOwnerAccountNamesystem NSFileAttributeKey NSFileGroupOwnerAccountNamesystem NSFileAttributeKey NSFilePosixPermissionssystem NSFileAttributeKey NSFileSystemNumbersystem NSFileAttributeKey NSFileSystemFileNumbersystem NSFileAttributeKey NSFileExtensionHiddensystem NSFileAttributeKey NSFileHFSCreatorCodesystem NSFileAttributeKey NSFileHFSTypeCodesystem NSFileAttributeKey NSFileImmutablesystem NSFileAttributeKey NSFileAppendOnlysystem NSFileAttributeKey NSFileCreationDatesystem NSFileAttributeKey NSFileOwnerAccountIDsystem NSFileAttributeKey NSFileGroupOwnerAccountIDsystem NSFileAttributeKey NSFileBusysystem NSFileAttributeKey NSFileProtectionKeysystem NSFileProtectionType NSFileProtectionNonesystem NSFileProtectionType NSFileProtectionCompletesystem NSFileProtectionType NSFileProtectionCompleteUnlessOpensystem NSFileProtectionType NSFileProtectionCompleteUntilFirstUserAuthenticationsystem NSFileAttributeKey NSFileSystemSizesystem NSFileAttributeKey NSFileSystemFreeSizesystem NSFileAttributeKey NSFileSystemNodessystem NSFileAttributeKey NSFileSystemFreeNodesBeginCDeclarationCFURLRef FM_URLForTemporaryDirectory();CFURLRef FM_URLForDirectory( NSSearchPathDirectory whichDirectory, NSSearchPathDomainMask domain );CFURLRef FM_URLForPreferencesDirectory();CFURLRef FM_URLForApplicationDirectory();CFArrayRef FM_ContentsOfDirectoryAtURL( CFURLRef url, CFArrayRef keys, NSDirectoryEnumerationOptions options );Boolean FM_CreateDirectoryAtURL( CFURLRef url, Boolean withIntermediateDirectories, CFDictionaryRef attributes );Boolean FM_CreateFileAtURL( CFURLRef url, CFDataRef contents, CFDictionaryRef attributes );Boolean FM_RemoveItemAtURL( CFURLRef url );Boolean FM_ReplaceItemAtURL( CFURLRef origURL, CFURLRef newURL );void FM_TrashItemAtURL( CFURLRef url );Boolean FM_CopyItemAtURL( CFURLRef srcURL, CFURLRef dstURL );Boolean FM_MoveItemAtURL( CFURLRef srcURL, CFURLRef dstURL );Boolean FM_FileExistsAtURL( CFURLRef url );Boolean FM_IsReadableFileAtURL( CFURLRef url );Boolean FM_IsWritableFileAtURL( CFURLRef url );Boolean FM_IsExecutableFileAtURL( CFURLRef url );Boolean FM_IsDeletableFileAtURL( CFURLRef url );Boolean FM_IsDirectoryAtURL( CFURLRef url );CFDictionaryRef FM_AttributesOfItemAtURL( CFURLRef url );Boolean FM_SetAttributesOfItemAtURL( CFURLRef url, CFDictionaryRef attributes );CFDataRef FM_ContentsAtURL( CFURLRef url );EndCBeginCFunctionCFURLRef FM_URLForTemporaryDirectory(){ return (CFURLRef)[NSURL fileURLWithPath:NSTemporaryDirectory()]; }CFURLRef FM_URLForDirectory( NSSearchPathDirectory whichDirectory, NSSearchPathDomainMask domain ){     NSArray *urls = [[NSFileManager defaultManager] URLsForDirectory:whichDirectory inDomains:domain];     if ( [urls count] ) return (CFURLRef)[urls objectAtIndex:0];     return NULL;}CFURLRef FM_URLForPreferencesDirectory(){ return (CFURLRef)[NSURL fileURLWithPath:[@"~/Library/Preferences" stringByExpandingTildeInPath]]; }CFURLRef FM_URLForApplicationDirectory(){ return (CFURLRef)[[[NSBundle mainBundle] bundleURL] URLByDeletingLastPathComponent]; }CFArrayRef FM_ContentsOfDirectoryAtURL( CFURLRef url, CFArrayRef keys, NSDirectoryEnumerationOptions options ){ return (CFArrayRef)[[NSFileManager defaultManager] contentsOfDirectoryAtURL:(NSURL *)url includingPropertiesForKeys:(NSArray *)keys options:options error:nil]; }Boolean FM_CreateDirectoryAtURL( CFURLRef url, Boolean withIntermediateDirectories, CFDictionaryRef attributes ){ return [[NSFileManager defaultManager] createDirectoryAtPath:[(NSURL *)url path] withIntermediateDirectories:withIntermediateDirectories attributes:(NSDictionary *)attributes error:nil]; }Boolean FM_CreateFileAtURL( CFURLRef url, CFDataRef contents, CFDictionaryRef attributes ){ return [[NSFileManager defaultManager] createFileAtPath:[(NSURL *)url path] contents:(NSData *)contents attributes:(NSDictionary *)attributes]; }Boolean FM_RemoveItemAtURL( CFURLRef url ){ return [[NSFileManager defaultManager] removeItemAtURL:(NSURL *)url error:nil]; }Boolean FM_ReplaceItemAtURL( CFURLRef origURL, CFURLRef newURL ){ return [[NSFileManager defaultManager] replaceItemAtURL:(NSURL *)origURL withItemAtURL:(NSURL *)newURL backupItemName:nil options:0 resultingItemURL:nil error:nil]; }void FM_TrashItemAtURL( CFURLRef url ){ [[NSWorkspace sharedWorkspace] recycleURLs:[NSArray arrayWithObject:(NSURL *)url] completionHandler:nil]; }Boolean FM_CopyItemAtURL( CFURLRef srcURL, CFURLRef dstURL ){ return [[NSFileManager defaultManager] copyItemAtURL:(NSURL *)srcURL toURL:(NSURL *)dstURL error:nil]; }Boolean FM_MoveItemAtURL( CFURLRef srcURL, CFURLRef dstURL ){ return [[NSFileManager defaultManager] moveItemAtURL:(NSURL *)srcURL toURL:(NSURL *)dstURL error:nil]; }Boolean FM_FileExistsAtURL( CFURLRef url ){ return [[NSFileManager defaultManager] fileExistsAtPath:[(NSURL *)url path]]; }Boolean FM_IsReadableFileAtURL( CFURLRef url ){ return [[NSFileManager defaultManager] isReadableFileAtPath:[(NSURL *)url path]]; }Boolean FM_IsWritableFileAtURL( CFURLRef url ){ return [[NSFileManager defaultManager] isWritableFileAtPath:[(NSURL *)url path]]; }Boolean FM_IsExecutableFileAtURL( CFURLRef url ){ return [[NSFileManager defaultManager] isExecutableFileAtPath:[(NSURL *)url path]]; }Boolean FM_IsDeletableFileAtURL( CFURLRef url ){ return [[NSFileManager defaultManager] isDeletableFileAtPath:[(NSURL *)url path]]; }Boolean FM_IsDirectoryAtURL( CFURLRef url ){     BOOL isDirectory = NO;     [[NSFileManager defaultManager] fileExistsAtPath:(NSString *)[(NSURL *)url path] isDirectory:&isDirectory];     return isDirectory;}CFDictionaryRef FM_AttributesOfItemAtURL( CFURLRef url ){ return (CFDictionaryRef)[[NSFileManager defaultManager] attributesOfItemAtPath:[(NSURL *)url path] error:nil]; }Boolean FM_SetAttributesOfItemAtURL( CFURLRef url, CFDictionaryRef attributes ){ return [[NSFileManager defaultManager] setAttributes:(NSDictionary *)attributes ofItemAtPath:[(NSURL *)url path] error:nil]; }CFDataRef FM_ContentsAtURL( CFURLRef url ){ return (CFDataRef)[[NSFileManager defaultManager] contentsAtPath:[(NSURL *)url path]]; }EndC/*  FM_URLForTemporaryDirectory    Return value: The URL of the temporary directory for the current user.*/toolbox fn FM_URLForTemporaryDirectory = CFURLRef/*  FM_URLForDirectory( whichDirectory, domain )    Params:      whichDirectory - The search path directory. Supported values are listed in Util_PathUtilities.incl.      domain         - The file system domain to search. The value for this parameter is one or more of the constants listed in Util_PathUtilities.incl.    Return value: The URL of the specified directory.*/toolbox fn FM_URLForDirectory( NSSearchPathDirectory whichDirectory, NSSearchPathDomainMask domain ) = CFURLRef/*  FM_URLForPreferencesDirectory    Return value: The URL of the preferences directory for the current user.*/toolbox fn FM_URLForPreferencesDirectory = CFURLRef/*  FM_URLForApplicationDirectory    Return value: The URL of the running application directory.*/toolbox fn FM_URLForApplicationDirectory = CFURLRef/*  FM_ContentsOfDirectoryAtURL( url, keys, options )    Performs a shallow search of the specified directory and returns URLs for the contained items.    Params:      url     - The URL for the directory whose contents you want to enumerate.      keys    - An array of keys that identify the file properties that you want pre-fetched for each item in the directory.      options - Options for the enumeration.                Because this function performs only shallow enumerations, options that prevent descending into subdirectories or packages are not allowed.                The only supported option is NSDirectoryEnumerationSkipsHiddenFiles.    Return value: An array of URLs, each of which identifies a file, directory, or symbolic link contained in url.*/toolbox fn FM_ContentsOfDirectoryAtURL( CFURLRef url, CFArrayRef keys, NSDirectoryEnumerationOptions options ) = CFArrayRef/*  FM_CreateDirectoryAtURL( url, withIntermediateDirectories, attributes )    Creates a directory with the given attributes at the specified URL.    Params:      url                         - A file URL that specifies the directory to create.      withIntermediateDirectories - If true, this function creates any non-existent parent directories as part of creating the directory in url.                                    If false, this function fails if any of the intermediate parent directories does not exist.      attributes                  - The file attributes for the new directory - see NSDirectoryEnumerationOptions.     Return value: true if the directory was created, true if createIntermediates is set and the directory already exists, or false if an error occurred.*/toolbox fn FM_CreateDirectoryAtURL( CFURLRef url, Boolean withIntermediateDirectories, CFDictionaryRef attributes ) = Boolean/*  FM_CreateFileAtURL( url, contents, attributes )    Creates a file with the specified content and attributes at the specified URL.    Params:      url        - The URL for the new file.      contents   - A data object containing the contents of the new file.      attributes - A dictionary containing the attributes to associate with the new file.                   You can use these attributes to set the owner and group numbers, file permissions, and modification date.                   For a list of keys, see NSFileAttributeKey. If you specify NULL for attributes, the file is created with a set of default attributes.    return value: true if the operation was successful or if the item already exists, otherwise false*/toolbox fn FM_CreateFileAtURL( CFURLRef url, CFDataRef contents, CFDictionaryRef attributes ) = Boolean/*  FM_RemoveItemAtURL( url )    Removes the file or directory at the specified URL.    Params:      url - A file URL specifying the file or directory to remove.            If the URL specifies a directory, the contents of that directory are recursively removed.            You may specify NULL for this parameter.    Return value: true if the item was removed successfully or if URL was NULL. Returns false if an error occurred. */toolbox fn FM_RemoveItemAtURL( CFURLRef url ) = Boolean/*  FM_ReplaceItemAtURL( origURL, newURL )    Replaces the contents of the item at the specified URL in a manner that insures no data loss occurs.    Params:      origURL - The item whose contents you want to replace.      newURL  - The item containing the new content for origURL. It is recommended that you put this item in a temporary directory as provided by the OS.                If a temporary directory is not available, put this item in a uniquely named directory that is in the same directory as the original item.    Return value: true if the replacement was successful or false if an error occurred.*/toolbox fn FM_ReplaceItemAtURL( CFURLRef origURL, CFURLRef newURL ) = Boolean/*  FM_TrashItemAtURL( url )  Moves the specified URL to the trash in the same manner as the Finder.*/toolbox FM_TrashItemAtURL( CFURLRef url )/*  FM_CopyItemAtURL( srcURL, dstURL )    Copies the file at the specified URL to a new location synchronously.    Params:      srcURL - The file URL that identifies the file you want to copy. The URL in this parameter must not be a file reference URL. This parameter must not be NULL.      dstURL - The URL at which to place the copy of srcURL.               The URL in this parameter must not be a file reference URL and must include the name of the file in its new location.               This parameter must not be NULL.    Return value: true if the item was copied successfully. Returns false if an error occurred.*/toolbox fn FM_CopyItemAtURL( CFURLRef srcURL, CFURLRef dstURL ) = Boolean/*  FM_MoveItemAtURL( srcURL, dstURL )    Moves the file or directory at the specified URL to a new location synchronously.    Params:      srcURL - The file URL that identifies the file or directory you want to move. The URL in this parameter must not be a file reference URL. This parameter must not be NULL.      dstURL - The new location for the item in srcURL.               The URL in this parameter must not be a file reference URL and must include the name of the file or directory in its new location.               This parameter must not be nil.    Return value: true if the item was moved successfully or the file manager’s delegate stopped the operation deliberately. Returns false if an error occurred.*/toolbox fn FM_MoveItemAtURL( CFURLRef srcURL, CFURLRef dstURL ) = Boolean/*  FM_FileExistsAtURL( url )    Indicates whether a file or directory exists at a specified URL.    Params:      url - The URL of the file or directory. If URL begins with a tilde (~), it must first be expanded; otherwise, this method returns false.    Return value: true if a file at the specified URL exists, or false if the file does not exist or its existence could not be determined.*/toolbox fn FM_FileExistsAtURL( CFURLRef url ) = Boolean/*  FM_IsReadableFileAtURL( url )    Indicates whether the invoking object appears able to read a specified file.    Params:      url - A file URL.    Return value: true if the current process has read privileges for the file at path; otherwise false if the process does not have read privileges or the existence of the file could not be determined.*/toolbox fn FM_IsReadableFileAtURL( CFURLRef url ) = Boolean/*  FM_IsWritableFileAtURL( url )    Indicates whether the invoking object appears able to write to specified file.    Params:      url - A file URL.    Return value: true if the current process has write privileges for the file at url; otherwise false if the process does not have write privileges or the existence of the file could not be determined.*/toolbox fn FM_IsWritableFileAtURL( CFURLRef url ) = Boolean/*  FM_IsExecutableFileAtURL( url )    Indicates whether the operating system appears able to execute a specified file.    Params:      url - A file URL.    Return value: true if the current process has execute privileges for the file at url; otherwise false if the process does not have execute privileges or the existence of the file could not be determined.*/toolbox fn FM_IsExecutableFileAtURL( CFURLRef url ) = Boolean/*  FM_IsDeletableFileAtURL( url )    indicates whether the invoking object appears able to delete a specified file.    Params:      url - A file URL.    Return value: true if the current process has delete privileges for the file at url; otherwise false if the process does not have delete privileges or the existence of the file could not be determined.*/toolbox fn FM_IsDeletableFileAtURL( CFURLRef url ) = Boolean/*  FM_IsDirectoryAtURL( url )    indicates whether the item at url is a directory.    Params:      url - A file URL.    Return value: true if the file at url is a directory; otherwise false*/toolbox fn FM_IsDirectoryAtURL( CFURLRef url ) = Boolean/*  FM_AttributesOfItemAtURL( url )    Returns the attributes of the item at a given URL.    Params:      url - The URL of a file or directory.    Return value: A CFDictionary object that describes the attributes (file, directory, symlink, and so on) of the file specified by path, or NULL if an error occurred.                  The keys in the dictionary are described in NSFileAttributeKey.*/toolbox fn FM_AttributesOfItemAtURL( CFURLRef url ) = CFDictionaryRef/*  FM_SetAttributesOfItemAtURL( url, attributes )    Sets the attributes of the specified file or directory.    Params:      url        - The URL of a file or directory.      attributes - A dictionary containing as keys the attributes to set for path and as values the corresponding value for the attribute.                   You can set the following attributes: NSFileBusy, NSFileCreationDate, NSFileExtensionHidden, NSFileGroupOwnerAccountID, NSFileGroupOwnerAccountName,                   NSFileHFSCreatorCode, NSFileHFSTypeCode, NSFileImmutable, NSFileModificationDate, NSFileOwnerAccountID, NSFileOwnerAccountName, NSFilePosixPermissions.                   You can change single attributes or any combination of attributes; you need not specify keys for all attributes.    Return value: true if all changes succeed. If any change fails, returns false, but it is undefined whether any changes actually occurred.*/toolbox fn FM_SetAttributesOfItemAtURL( CFURLRef url, CFDictionaryRef attributes ) = Boolean/*  FM_ContentsAtURL( url )    Returns the contents of the file at the specified URL.    Params:      url - The URL of the file whose contents you want.    Return value: A CFData object with the contents of the file. If url specifies a directory, or if some other error occurs, this method returns NULL.*/toolbox fn FM_ContentsAtURL( CFURLRef url ) = CFDataRef