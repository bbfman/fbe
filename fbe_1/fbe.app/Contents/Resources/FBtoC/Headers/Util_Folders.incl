clear local modedim pb.128dim as OSErr errlocal fn FBGetMakeFolder(FolderName$,vol%,dir&)'~'1pb.ioDirID&     = dir&pb.ioVRefNum%   = vol%pb.ioFileName&  = @FolderName$err = FN PBGetCatInfoSync( (ptr)@pb )long if errpb.ioDirID& = dir&err = FN PBDirCreateSync( (ptr)@pb )if err then pb.ioDirID& = 0end ifdir& = pb.ioDirID&end fn = dir&local modedim as long p1,p2dim @ vol%,dir&local fn FBGetMakePath(path$,volx%,dirx&)'~'1vol% = volx%dir& = dirx&p1 = 1dop2 = instr(p1,path$,":")long if p2dir& = fn FBGetMakeFolder(mid$(path$,p1,(p2-p1)),vol%,dir&)p1 = p2+1xelselong if p1 < len(path$)dir& = fn FBGetMakeFolder(mid$(path$,p1),vol%,dir&)end ifend ifuntil p2 == 0 or dir& == 0end fn = dir&