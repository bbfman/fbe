/****************************************************************************   Util_Nib.incl   Bernie Wylde   20090704   The following functions are used with Carbon nibs and *not* Cocoa nibs*****************************************************************************/include "Tlbx IBCarbonRuntime.incl"local fn NibCreateReference( nibName as Str255, outNib as ^IBNibRef )'~'1dim as CFStringRef   namedim as OSStatus      errname = fn CFStringCreateWithPascalString( _kCFAllocatorDefault, nibName, _kCFStringEncodingMacRoman )err = fn CreateNibReference( name, #outNib )CFRelease( name )end fn = errlocal fn NibCreateWindow( nibName as Str255, wndName as Str255, outWnd as ^WindowRef )'~'1dim as IBNibRef      nibdim as CFStringRef   objdim as OSStatus      errerr = fn NibCreateReference( nibName, @nib )if ( err ) then exit fnobj = fn CFStringCreateWithPascalString( _kCFAllocatorDefault, wndName, _kCFStringEncodingMacRoman )err = fn CreateWindowFromNib( nib, obj, #outWnd )CFRelease( obj )DisposeNibReference( nib )end fn = errlocal fn NibCreateMenu( nibName as Str255, menuName as Str255, outMenu as ^MenuRef )'~'1dim as IBNibRef      nibdim as CFStringRef   objdim as OSStatus      errerr = fn NibCreateReference( nibName, @nib )if ( err ) then exit fnobj = fn CFStringCreateWithPascalString( _kCFAllocatorDefault, menuName, _kCFStringEncodingMacRoman )err = fn CreateMenuFromNib( nib, obj, #outMenu )CFRelease( obj )DisposeNibReference( nib )end fn = errlocal fn NibSetMenuBar( nibName as Str255, mBarName as Str255 )'~'1dim as IBNibRef      nibdim as CFStringRef   objdim as OSStatus      errerr = fn NibCreateReference( nibName, @nib )if ( err ) then exit fnobj = fn CFStringCreateWithPascalString( _kCFAllocatorDefault, mBarName, _kCFStringEncodingMacRoman )err = fn SetMenuBarFromNib( nib, obj )CFRelease( obj )DisposeNibReference( nib )end fn = err